<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8"/>
  <title>Dự đoán IQA</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
<div class="container">
  <h1>Dự đoán điểm chất lượng ảnh</h1>
  <p class="muted">Chọn 1 ảnh để chấm điểm.</p>

  <div class="card">
    <input id="file" type="file" accept="image/*"/>
    <div style="margin-top:12px;">
      <img id="preview" style="max-width:100%; display:none; border-radius:12px;"/>
    </div>

    <div style="margin-top:12px;">
      <button class="btn" id="btn">Chấm điểm</button>
    </div>

    <pre id="out" class="result" style="margin-top:12px;"></pre>
  </div>
</div>

<script>
const file = document.getElementById("file");
const preview = document.getElementById("preview");
const btn = document.getElementById("btn");
const out = document.getElementById("out");

file.addEventListener("change", () => {
  out.textContent = "";
  const f = file.files?.[0];
  if (!f) return;
  const reader = new FileReader();
  reader.onload = () => {
    preview.src = reader.result;
    preview.style.display = "block";
  };
  reader.readAsDataURL(f);
});

btn.addEventListener("click", async () => {
  const f = file.files?.[0];
  if (!f) { out.textContent = "Bạn chưa chọn ảnh."; return; }

  out.textContent = "Đang chấm điểm...";
  const fd = new FormData();
  fd.append("file", f);

  const res = await fetch("/predict", { method:"POST", body: fd });
  const data = await res.json();
  out.textContent = JSON.stringify(data, null, 2);
});
</script>
</body>
</html>
